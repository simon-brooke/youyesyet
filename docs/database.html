<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>Database Specification</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Youyesyet</span> <span class="project-version">0.2.2-SNAPSHOT</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="authorisation.html"><div class="inner"><span>Security and authorisation</span></div></a></li><li class="depth-1 "><a href="competitors.html"><div class="inner"><span>Competitor Analysis</span></div></a></li><li class="depth-1  current"><a href="database.html"><div class="inner"><span>Database Specification</span></div></a></li><li class="depth-1 "><a href="scaling.html"><div class="inner"><span>YouYesYet: Scaling</span></div></a></li><li class="depth-1 "><a href="userspec.html"><div class="inner"><span>YouYesYet: User-oriented specification</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>youyesyet</span></div></div></li><li class="depth-2 branch"><a href="youyesyet.cache.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>cache</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>canvasser-app</span></div></div></li><li class="depth-3 branch"><a href="youyesyet.canvasser-app.ajax.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ajax</span></div></a></li><li class="depth-3 branch"><a href="youyesyet.canvasser-app.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-3 branch"><a href="youyesyet.canvasser-app.gis.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>gis</span></div></a></li><li class="depth-3 branch"><a href="youyesyet.canvasser-app.handlers.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>handlers</span></div></a></li><li class="depth-3 branch"><a href="youyesyet.canvasser-app.state.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>state</span></div></a></li><li class="depth-3 branch"><a href="youyesyet.canvasser-app.subscriptions.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>subscriptions</span></div></a></li><li class="depth-3 branch"><a href="youyesyet.canvasser-app.ui-utils.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ui-utils</span></div></a></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>views</span></div></div></li><li class="depth-4 branch"><a href="youyesyet.canvasser-app.views.about.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>about</span></div></a></li><li class="depth-4 branch"><a href="youyesyet.canvasser-app.views.building.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>building</span></div></a></li><li class="depth-4 branch"><a href="youyesyet.canvasser-app.views.dwelling.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>dwelling</span></div></a></li><li class="depth-4 branch"><a href="youyesyet.canvasser-app.views.elector.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>elector</span></div></a></li><li class="depth-4 branch"><a href="youyesyet.canvasser-app.views.followup.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>followup</span></div></a></li><li class="depth-4 branch"><a href="youyesyet.canvasser-app.views.gdpr.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>gdpr</span></div></a></li><li class="depth-4 branch"><a href="youyesyet.canvasser-app.views.issue.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>issue</span></div></a></li><li class="depth-4 branch"><a href="youyesyet.canvasser-app.views.issues.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>issues</span></div></a></li><li class="depth-4"><a href="youyesyet.canvasser-app.views.map.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>map</span></div></a></li><li class="depth-2 branch"><a href="youyesyet.config.html"><div class="inner"><span class="tree" style="top: -548px;"><span class="top" style="height: 557px;"></span><span class="bottom"></span></span><span>config</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>db</span></div></div></li><li class="depth-3"><a href="youyesyet.db.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="youyesyet.handler.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>handler</span></div></a></li><li class="depth-2 branch"><a href="youyesyet.layout.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>layout</span></div></a></li><li class="depth-2 branch"><a href="youyesyet.locality.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>locality</span></div></a></li><li class="depth-2 branch"><a href="youyesyet.middleware.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>middleware</span></div></a></li><li class="depth-2 branch"><a href="youyesyet.oauth.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>oauth</span></div></a></li><li class="depth-2 branch"><a href="youyesyet.outqueue.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>outqueue</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>routes</span></div></div></li><li class="depth-3 branch"><a href="youyesyet.routes.auto.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>auto</span></div></a></li><li class="depth-3 branch"><a href="youyesyet.routes.auto-json.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>auto-json</span></div></a></li><li class="depth-3 branch"><a href="youyesyet.routes.home.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>home</span></div></a></li><li class="depth-3 branch"><a href="youyesyet.routes.issue-experts.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>issue-experts</span></div></a></li><li class="depth-3 branch"><a href="youyesyet.routes.logged-in.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>logged-in</span></div></a></li><li class="depth-3 branch"><a href="youyesyet.routes.manual.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>manual</span></div></a></li><li class="depth-3 branch"><a href="youyesyet.routes.oauth.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>oauth</span></div></a></li><li class="depth-3 branch"><a href="youyesyet.routes.rest.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>rest</span></div></a></li><li class="depth-3 branch"><a href="youyesyet.routes.roles.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>roles</span></div></a></li><li class="depth-3"><a href="youyesyet.routes.services.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>services</span></div></a></li><li class="depth-2 branch"><a href="youyesyet.utils.html"><div class="inner"><span class="tree" style="top: -331px;"><span class="top" style="height: 340px;"></span><span class="bottom"></span></span><span>utils</span></div></a></li><li class="depth-2"><a href="youyesyet.validation.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>validation</span></div></a></li></ul></div><div class="document" id="content"><div class="doc"><div class="markdown"><h1><a href="#database-specification" name="database-specification"></a>Database Specification</h1>
<p>Note that this is a work in progress. Read it in concert with the Entity-Relationship Diagram.</p>
<p>Tables are listed in alphabetical order.</p>
<h2><a href="#address" name="address"></a>Address</h2>
<p>The postal address of a building which contains at least one dwelling at which electors are registered.</p>
<pre><code>CREATE TABLE IF NOT EXISTS addresses (
    id integer NOT NULL,
    address character varying(256) NOT NULL,
    postcode character varying(16),
    phone character varying(16),
    district_id integer,
    latitude real,
    longitude real
);
</code></pre>
<h2><a href="#authority" name="authority"></a>Authority</h2>
<p>An <em>oauth</em> authority which authenticates canvassers. <em>Note that</em> there will need to be substantially more in this table but I don’t yet know what.</p>
<pre><code>CREATE TABLE IF NOT EXISTS authorities (
    id character varying(32) NOT NULL
);
</code></pre>
<h2><a href="#canvasser" name="canvasser"></a>Canvasser</h2>
<p>A user of the system.</p>
<pre><code>CREATE TABLE IF NOT EXISTS canvassers (
    id serial,
    username character varying(32) NOT NULL,
    fullname character varying(64) NOT NULL,
    elector_id integer,
    address_id integer NOT NULL,
    phone character varying(16),
    email character varying(128),
    authority_id character varying(32) NOT NULL,
    authorised boolean
);
</code></pre>
<h2><a href="#district" name="district"></a>District</h2>
<p>An electoral district.</p>
<pre><code>CREATE TABLE IF NOT EXISTS districts (
    id integer NOT NULL,
    name character varying(64) NOT NULL
);
</code></pre>
<h2><a href="#dwelling" name="dwelling"></a>Dwelling</h2>
<p>A dwelling at which electors are registered. Most addresses obviously have only one dwelling, but in flatted buildings there will be multiple dwellings. The <strong>sub_address</strong> field contains information to distinguish the dwelling, e.g. ‘flat 2.1’.</p>
<pre><code>CREATE TABLE IF NOT EXISTS dwellings (
    id serial NOT NULL primary key,
    address_id integer NOT NULL references addresses(id),
    sub_address varchar(16)
);
</code></pre>
<h2><a href="#elector" name="elector"></a>Elector</h2>
<p>Someone entitled to cast a vote in the referendum.</p>
<pre><code>CREATE TABLE IF NOT EXISTS electors (
    id integer NOT NULL,
    name character varying(64) NOT NULL,
    dwelling_id integer NOT NULL,
    phone character varying(16),
    email character varying(128)
);
</code></pre>
<h2><a href="#followup-action" name="followup-action"></a>Followup Action</h2>
<p>An action performed by an issue expert in response to a followup request.</p>
<pre><code>CREATE TABLE IF NOT EXISTS followupactions (
    id integer NOT NULL,
    request_id integer NOT NULL,
    actor integer NOT NULL,
    date timestamp with time zone DEFAULT now() NOT NULL,
    notes text,
    closed boolean
);
</code></pre>
<h2><a href="#followup-method" name="followup-method"></a>Followup Method</h2>
<p>A method for responding to a followup request; reference data.</p>
<pre><code>CREATE TABLE IF NOT EXISTS followupmethods (
    id character varying(32) NOT NULL
);

insert into followupmethods values ('Telephone');
insert into followupmethods values ('eMail');
insert into followupmethods values ('Post');
</code></pre>
<h2><a href="#followup-request" name="followup-request"></a>Followup Request</h2>
<p>A request recorded by a canvasser for an issue expert to contact an elector with regard to a particular issue.</p>
<pre><code>CREATE TABLE IF NOT EXISTS followuprequests (
    id integer NOT NULL,
    elector_id integer NOT NULL,
    visit_id integer NOT NULL,
    issue_id character varying(32) NOT NULL,
    method_id character varying(32) NOT NULL
);
</code></pre>
<h2><a href="#intention" name="intention"></a>Intention</h2>
<p>An intention, by an elector, to vote for an option; captured by a canvasser during a visit.</p>
<pre><code>CREATE TABLE IF NOT EXISTS intentions (
    id serial not null,
    elector integer not null references elector(id),
    option varchar(32) not null references option(id),
    visit integer not null references visit(id),
    date timestamp with time zone DEFAULT now() NOT NULL
);
</code></pre>
<h2><a href="#issue" name="issue"></a>Issue</h2>
<p>An issue which might affect electors’ decisions regarding their intention.</p>
<pre><code>CREATE TABLE IF NOT EXISTS issues (
    id character varying(32) NOT NULL,
    url character varying(256),
    content varchar(1024),
    current default false
);
</code></pre>
<h2><a href="#issue-expertise" name="issue-expertise"></a>Issue expertise</h2>
<p>Expertise of a canvasser able to use a method, in an issue.</p>
<pre><code>CREATE TABLE IF NOT EXISTS issueexpertise (
    canvasser_id integer NOT NULL,
    issue_id character varying(32) NOT NULL,
    method_id character varying(32) NOT NULL
);
</code></pre>
<h2><a href="#option" name="option"></a>Option</h2>
<p>An option for which an elector may have an intention to vote.</p>
<pre><code>CREATE TABLE IF NOT EXISTS options (
    id character varying(32) NOT NULL
);
</code></pre>
<h2><a href="#role" name="role"></a>Role</h2>
<p>A role (other than basic <em>Canvasser</em>) that a user may have in the system. Reference data.</p>
<pre><code>create table if not exists roles (
  id serial primary key,
  name varchar(64) not null
);
</code></pre>
<h2><a href="#role-member" name="role-member"></a>Role Member</h2>
<p>Membership of a user (*Canvasser*) of an additional role; link table.</p>
<pre><code>create table if not exists rolememberships (
  role_id integer not null references roles(id),
  canvasser_id integer not null references canvassers(id)
);
</code></pre>
<h2><a href="#team" name="team"></a>Team</h2>
<p>A team of canvassers in a locality who are known to one another and frequently canvas together.</p>
<pre><code>create table if not exists teams (
  id serial primary key,
  name varchar(64) not null,
  district_id integer not null references districts(id),
  latitude real,
  longitude real
);
</code></pre>
<h2><a href="#team-member" name="team-member"></a>Team Member</h2>
<p>Membership of a user (*Canvasser*) of a particular team. Canvassers may join multiple teams. Link table.</p>
<pre><code>create table if not exists teammemberships (
  team_id integer not null references teams(id),
  canvasser_id integer not null references canvassers(id)
);
</code></pre>
<h2><a href="#team-organiser" name="team-organiser"></a>Team Organiser</h2>
<p>A relationship which defines a user (*Canvasser*) as an organiser of a team. A team may have more than one organiser. An organiser (if they also have the role ‘Recruiter’, which they often will have) may recruit additional Canvassers as members of their team, or accept applications by canvassers to join their team. An organiser may promote a member of the team to organiser of the team, and may also exclude a member from the team.</p>
<pre><code>create table if not exists teamorganiserships (
  team_id integer not null references teams(id),
  canvasser_id integer not null references canvassers(id)
);
</code></pre>
<h2><a href="#visit" name="visit"></a>Visit</h2>
<p>A visit by a canvasser to an address on a date to solicit intentions from electors.</p>
<pre><code>CREATE TABLE IF NOT EXISTS visits (
    id integer NOT NULL,
    address_id integer NOT NULL,
    canvasser_id integer NOT NULL,
    date timestamp with time zone DEFAULT now() NOT NULL
);
</code></pre></div></div></div></body></html>